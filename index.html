<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>WOFF Hello World</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 50px;font-size:1.2em; }
  </style>
  <script charset="utf-8" src="https://static.worksmobile.net/static/wm/woff/edge/3.7.1/sdk.js"></script>
</head>
<body>
  <h1>Hello World from WOFF!</h1>
  <div id="assetList">載入中...</div>

<script>

document.addEventListener('DOMContentLoaded', () => {
      if (typeof woff === 'undefined') {
        document.getElementById('assetList').textContent = '請在 LINE WORKS WOFF App 中開啟';
        return;
      }

      // 取得 Access Token
      woff.getAccessToken()
        .then(token => {
          console.log('Access Token:', token);

          // 呼叫 LINE WORKS API 取得使用者資訊
          return fetch('https://apis.worksmobile.com/r/iJP5zTXXN57sPmTPzoI7mQ/v1/user/get', {
            headers: {
              'Authorization': `Bearer ${token}`
            }
          });
        })
        .then(res => res.json())
        .then(user => {
          console.log('User Info:', user);
          document.getElementById('assetList').textContent = `您好，${user.name}`;
        })
        .catch(err => {
          console.error('取得使用者資訊失敗:', err);
          document.getElementById('assetList').textContent = '登入失敗，請檢查設定';
        });
    });


</script>

  <!-- <script>
    
woff.getUserInfo()
    .then(user => {
      console.log(user); // 檢查完整資訊
      const userName = user.displayName; // 使用者顯示名稱
      // document.getElementById('userName').textContent = `您好，${userName}`;
    
  fetch('https://keeperlist-468585210906.asia-east1.run.app', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ user_name: { value: userName } })
  })
  .then(res => res.json())
  .then(data => {
    
  // 取出 records
  const records = data.records;
  
  // 轉換成簡單陣列
  const assets = records.map(record => {
    return {
      資產號碼組合: record["資產號碼組合"].value,
      製品名: record["製品名"].value,
      存放地點: record["存放地點"].value
    };
  });
console.log(assets)

// 顯示成表格
  const html = `
    <table border="1" style="width:100%; text-align:left;">
      <tr><th>資產號碼</th><th>製品名</th><th>存放地點</th></tr>
      ${assets.map(item => `
        <tr>
          <td>${item.資產號碼組合}</td>
          <td>${item.製品名}</td>
          <td>${item.存放地點}</td>
        </tr>
      `).join('')}
    </table>
  `;
  document.getElementById('assetList').innerHTML = html;
})
})
  .catch(err => console.error(err));

</script> -->

</body>



</html>



























